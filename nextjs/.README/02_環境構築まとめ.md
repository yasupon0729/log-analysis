# ç’°å¢ƒæ§‹ç¯‰ã¾ã¨ã‚ - ãƒ­ã‚°è§£æã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

## ğŸ¯ æ¦‚è¦
S3ã‹ã‚‰ç›´æ¥JSONãƒ­ã‚°ã‚’å–å¾—ã—ã€ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤ºã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç’°å¢ƒæ§‹ç¯‰æ‰‹é †ã§ã™ã€‚
ãƒ€ãƒ¼ã‚¯ãƒ»é’åŸºèª¿ã®UIã§ã€èªè¨¼ãƒ»DBä¸è¦ã®ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆã‚’æ¡ç”¨ã—ã¾ã™ã€‚

## ğŸ§± å¿…è¦ãªæŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **Runtime**: Bun 1.3.1ï¼ˆasdf ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå˜ä½ã«å›ºå®šï¼‰
- **Framework**: Next.js v15 (App Router)
- **Language**: TypeScript

### UIãƒ»ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°
- **CSS**: Panda CSS (ãƒ€ãƒ¼ã‚¯å›ºå®šãƒ»é’åŸºèª¿ãƒ†ãƒ¼ãƒ)
- **Table**: TanStack Table (ä»®æƒ³åŒ–å¯¾å¿œ)
- **Components**: å¿…è¦ã«å¿œã˜ã¦è¿½åŠ 

### é–‹ç™ºãƒ„ãƒ¼ãƒ«
- **Linter/Formatter**: Biome
- **Environment**: WSL (Windows Subsystem for Linux)

## ğŸ“ å‰ææ¡ä»¶

### ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶
- WSL2ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ï¼ˆWindowsç’°å¢ƒã®å ´åˆï¼‰
- Node.js 18.18ä»¥ä¸Šï¼ˆBunãŒå†…éƒ¨ã§ä½¿ç”¨ï¼‰
- Git

### AWSé–¢é€£
- AWS CLIãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- S3ã‚¢ã‚¯ã‚»ã‚¹ç”¨ã®IAMãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆæ¸ˆã¿
- ä»¥ä¸‹ã®æ¨©é™ã‚’æŒã¤IAMãƒãƒªã‚·ãƒ¼è¨­å®šæ¸ˆã¿ï¼š
  - `s3:ListBucket` (prefix: `logs/`)
  - `s3:GetObject` (`logs/`é…ä¸‹)

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. asdf ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨ Bun ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã§ã¯ Bun 1.3.1 ã«æƒãˆã‚‹ãŸã‚ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¨ã—ã¦ asdf ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚äº‹å‰ã« asdf æœ¬ä½“ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚

```bash
# å¿…è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt update
sudo apt install -y curl git

# asdf ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.14.1

# ã‚·ã‚§ãƒ«ã®åˆæœŸåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«è¿½è¨˜ï¼ˆbash ã®ä¾‹ï¼‰
echo '. "$HOME/.asdf/asdf.sh"' >> ~/.bashrc
echo '. "$HOME/.asdf/completions/asdf.bash"' >> ~/.bashrc

# æ–°ã—ã„ã‚·ã‚§ãƒ«ã‚’é–‹ãã‹ã€è¨­å®šã‚’èª­ã¿è¾¼ã‚€
source ~/.bashrc

# asdf ã® Bun ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¿½åŠ 
asdf plugin-add bun https://github.com/cometkim/asdf-bun.git

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§åˆ©ç”¨ã™ã‚‹ Bun ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
asdf install bun 1.3.1

# ãƒªãƒã‚¸ãƒˆãƒªãƒ«ãƒ¼ãƒˆã§ version ã‚’å›ºå®šï¼ˆ.tool-versions ãŒä½œæˆã•ã‚Œã¾ã™ï¼‰
asdf local bun 1.3.1

# ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
bun --version

# PATH ã®å„ªå…ˆé †ä½ã‚’èª¿æ•´ï¼ˆæ—¢å­˜ã® ~/.bun/bin ãŒã‚ã‚‹å ´åˆï¼‰
echo 'export PATH="$HOME/.asdf/shims:$HOME/.asdf/bin:$PATH"' >> ~/.bashrc
source ~/.bashrc
which bun  # -> ~/.asdf/shims/bun
```

â€» Windows ç’°å¢ƒã§ã¯ WSL2 ä¸Šã§ asdf ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

### 2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir nextjs
cd nextjs

# Next.js 15ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–
bunx create-next-app@latest .
# è¨­å®šãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ¨å¥¨é¸æŠï¼š
# âœ” Would you like to use ESLint? Biomeã‚’é¸æŠ
# âœ” Would you like to use Tailwind CSS? â€¦ No (Panda CSSã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚)

```


### 3. Biomeã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# Biomeã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
bun add -D @biomejs/biome

# BiomeåˆæœŸåŒ–
bunx biome init

# biome.jsonã®è¨­å®š
```

`biome.json`ã®åŸºæœ¬è¨­å®š(éšå±¤æ³¨æ„):
```json
{
  "$schema": "https://biomejs.dev/schemas/2.2.5/schema.json",
  "vcs": {
    "enabled": true,
    "clientKind": "git",
    "useIgnoreFile": true
  },
  "files": {
    "ignoreUnknown": true
  },
  "formatter": {
    "enabled": true,
    "indentStyle": "space"
  },
  "linter": {
    "enabled": true,
    "rules": {
      "recommended": true,
      "style": {
        "noParameterAssign": "error",
        "useAsConstAssertion": "error",
        "useDefaultParameterLast": "error",
        "useEnumInitializers": "error",
        "useSelfClosingElements": "error",
        "useSingleVarDeclarator": "error",
        "noUnusedTemplateLiteral": "error",
        "useNumberNamespace": "error",
        "noInferrableTypes": "error",
        "noUselessElse": "error"
      },
      "performance": {
        "noImgElement": "off"
      }
    }
  },
  "javascript": {
    "formatter": {
      "quoteStyle": "double"
    }
  }
}

```

### 4. Panda CSSã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—(åˆ¥ãƒšãƒ¼ã‚¸å‚ç…§ã€‚log-analysis/.README.md/03_CSSã®å°å…¥.md)

```bash
# Panda CSSã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
bun add -D @pandacss/dev
bun add @pandacss/preset-panda

# Panda CSSåˆæœŸåŒ–
bunx panda init --postcss

# panda.config.tsã®è¨­å®šï¼ˆãƒ€ãƒ¼ã‚¯ãƒ»é’åŸºèª¿ãƒ†ãƒ¼ãƒï¼‰
```

`panda.config.ts`ã®åŸºæœ¬è¨­å®š:
```typescript
import { defineConfig, defineGlobalStyles } from '@pandacss/dev'

export default defineConfig({
  preflight: true,
  include: ['./app/**/*.{ts,tsx,js,jsx}', './components/**/*.{ts,tsx,js,jsx}'],
  exclude: [],
  theme: {
    extend: {
      tokens: {
        colors: {
          primary: {
            50: { value: '#e6f2ff' },
            100: { value: '#bae3ff' },
            200: { value: '#7cc4fa' },
            300: { value: '#47a3f3' },
            400: { value: '#2186eb' },
            500: { value: '#0967d2' },
            600: { value: '#0552b5' },
            700: { value: '#03449e' },
            800: { value: '#01337d' },
            900: { value: '#002159' },
          },
          dark: {
            bg: { value: '#0f172a' },
            surface: { value: '#1e293b' },
            border: { value: '#334155' },
            text: { value: '#e2e8f0' },
            textMuted: { value: '#94a3b8' },
          }
        }
      },
      semanticTokens: {
        colors: {
          background: { value: { base: '{colors.dark.bg}' } },
          surface: { value: { base: '{colors.dark.surface}' } },
          border: { value: { base: '{colors.dark.border}' } },
          text: { value: { base: '{colors.dark.text}' } },
          textMuted: { value: { base: '{colors.dark.textMuted}' } },
        }
      }
    }
  },
  globalCss: defineGlobalStyles({
    body: {
      bg: 'background',
      color: 'text',
      fontFamily: 'system-ui, -apple-system, sans-serif',
    }
  }),
  outdir: 'styled-system',
})
```

### 5. Biomeã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— (ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ¬ãƒ™ãƒ«)

**é‡è¦**: ãƒ¢ãƒãƒ¬ãƒæ§‹æˆã§ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ¬ãƒ™ãƒ«ã«é…ç½®ã—ã¾ã™

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã§Biomeã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
cd /home/yasunari/KNiT/log-analysis
bun add -D @biomejs/biome

# BiomeåˆæœŸåŒ– (ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å®Ÿè¡Œ)
bunx biome init

# VSCodeæ‹¡å¼µæ©Ÿèƒ½ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# VSCodeã®æ‹¡å¼µæ©Ÿèƒ½ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã‹ã‚‰ã€ŒBiomeã€ã‚’æ¤œç´¢ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```

ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ¬ãƒ™ãƒ«ã®`package.json`ä½œæˆ:
```json
{
  "name": "log-analysis-workspace",
  "private": true,
  "workspaces": [
    "nextjs",
    "backend"
  ],
  "scripts": {
    "dev": "cd nextjs && bun dev",
    "build": "cd nextjs && bun build",
    "format": "bunx @biomejs/biome format --write .",
    "lint": "bunx @biomejs/biome check .",
    "lint:fix": "bunx @biomejs/biome check --write ."
  },
  "devDependencies": {
    "@biomejs/biome": "^1.9.4"
  }
}
```

`biome.json`ã®åŸºæœ¬è¨­å®š (ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ):
```json
{
  "$schema": "https://biomejs.dev/schemas/2.2.5/schema.json",
  "vcs": {
    "enabled": true,
    "clientKind": "git",
    "useIgnoreFile": true
  },
  "files": {
    "ignoreUnknown": true
  },
  "formatter": {
    "enabled": true,
    "indentStyle": "space",
    "indentWidth": 2,
    "lineWidth": 100
  },
  "linter": {
    "enabled": true,
    "rules": {
      "recommended": true,
      "style": {
        "noParameterAssign": "error",
        "useAsConstAssertion": "error",
        "useDefaultParameterLast": "error",
        "useEnumInitializers": "error",
        "useSelfClosingElements": "error",
        "useSingleVarDeclarator": "error",
        "noUnusedTemplateLiteral": "error",
        "useNumberNamespace": "error",
        "noInferrableTypes": "error",
        "noUselessElse": "error"
      }
    }
  },
  "javascript": {
    "formatter": {
      "quoteStyle": "double"
    }
  },
  "organizeImports": {
    "enabled": true
  }
}
```

VSCodeè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« `.vscode/settings.json` (ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ¬ãƒ™ãƒ«):
```json
{
  "editor.defaultFormatter": "biomejs.biome",
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "quickfix.biome": "explicit",
    "source.organizeImports.biome": "explicit"
  },
  "biome.enabled": true,
  "biome.configPath": "./biome.json",
  "[javascript]": {
    "editor.defaultFormatter": "biomejs.biome"
  },
  "[typescript]": {
    "editor.defaultFormatter": "biomejs.biome"
  },
  "[javascriptreact]": {
    "editor.defaultFormatter": "biomejs.biome"
  },
  "[typescriptreact]": {
    "editor.defaultFormatter": "biomejs.biome"
  },
  "[json]": {
    "editor.defaultFormatter": "biomejs.biome"
  },
  "[jsonc]": {
    "editor.defaultFormatter": "biomejs.biome"
  },
  "[css]": {
    "editor.defaultFormatter": "biomejs.biome"
  }
}
```


ãã®ä»–
```bash
# nextjsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å®Ÿè¡Œ
cd nextjs

# æ—¥ä»˜å‡¦ç†
bun add date-fns

# ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
bun add zod

# é–‹ç™ºç”¨ãƒ„ãƒ¼ãƒ«
bun add -D @types/node

# AWS SDK v3 
bun add @aws-sdk/client-s3

# TanStack Table v8
cd nextjs
bun add @tanstack/react-table @tanstack/react-virtual
```

###  ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

`nextjs/.env.local`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ:

```bash
# S3è¨­å®š
S3_REGION=ap-northeast-1
S3_BUCKET=gexel-secure-storage
S3_PREFIX=logs/
AWS_ACCESS_KEY_ID=your_access_key_here
AWS_SECRET_ACCESS_KEY=your_secret_key_here

# ã‚¢ãƒ—ãƒªè¨­å®š
NEXT_PUBLIC_APP_NAME=Log Analysis Dashboard
NEXT_PUBLIC_MAX_LOGS_PER_REQUEST=10000
JUDGE_IMAGE_USERS="y-matsumoto,t-nishimoto,n-tsuchiya,m-kubouchi" # JudgeImageã«ç´ã¥ã‘ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã®ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Š

# MySQL(èª­ã¿å–ã‚Šå°‚ç”¨)è¨­å®š
MYSQL_HOST=127.0.0.1
MYSQL_PORT=3306
MYSQL_USER=readonly_user
MYSQL_PASSWORD=your_password_here
MYSQL_DATABASE=log_analytics
MYSQL_POOL_SIZE=10        # ä»»æ„: ãƒ—ãƒ¼ãƒ«æ¥ç¶šæ•° (æ—¢å®šå€¤: 10)
MYSQL_TIMEZONE=Asia/Tokyo # ä»»æ„: DBã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ (æ—¢å®šå€¤: Z)
```

`MYSQL_POOL_SIZE` ã¨ `MYSQL_TIMEZONE` ã¯çœç•¥å¯èƒ½ã§ã™ã€‚èª­ã¿å–ã‚Šå°‚ç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å¿…ãšåˆ©ç”¨ã—ã€æ›´æ–°ç³»æ¨©é™ã‚’ä»˜ä¸ã—ãªã„ã§ãã ã•ã„ã€‚

### 9.1 WSL ã‹ã‚‰ã® MySQL (SSH ãƒˆãƒ³ãƒãƒ«) æ¥ç¶šæ‰‹é †

Windows å´ã«ã‚ã‚‹ `.pem` ç§˜å¯†éµã‚’åˆ©ç”¨ã—ã¦è¸ã¿å°ã‚µãƒ¼ãƒãƒ¼çµŒç”±ã§ MySQL ã«æ¥ç¶šã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã§ WSL ä¸Šã«ãƒˆãƒ³ãƒãƒ«ã‚’å¸¸æ™‚å¼µã‚Œã‚‹ã‚ˆã†è¨­å®šã—ã¾ã™ã€‚

1. **ç§˜å¯†éµã‚’ WSL ã«ã‚³ãƒ”ãƒ¼(wslã«é…ç½®ã—ã¦ã„ãªã„å ´åˆ**

   ```bas
   mkdir -p ~/.ssh
   cp /mnt/c/Users/<Windowsãƒ¦ãƒ¼ã‚¶ãƒ¼å>/.ssh/gexel_cloud.pem ~/.ssh/
   chmod 600 ~/.ssh/gexel_cloud.pem
   ```

2. **SSH è¨­å®š (`~/.ssh/config`) ã«ãƒˆãƒ³ãƒãƒ«å®šç¾©ã‚’è¿½åŠ **

   ```text
   Host gexel-cloud-tunnel
     HostName gexel.cloud
     User ubuntu
     IdentityFile ~/.ssh/gexel_cloud.pem
     LocalForward 3307 localhost:3306
     ServerAliveInterval 60
     ServerAliveCountMax 3
   ```

   - `LocalForward` ã®å·¦å´ `3307` ã¯ WSL å´ã§å¾…ã¡å—ã‘ã‚‹ãƒãƒ¼ãƒˆã€‚ä½¿ç”¨ä¸­ã§ã‚ã‚Œã°ç©ºããƒãƒ¼ãƒˆã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚
   - å³å´ `localhost:3306` ã¯è¸ã¿å°ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è¦‹ãŸ MySQL ã®å¾…ã¡å—ã‘å…ˆã§ã™ã€‚MySQL ãŒåˆ¥ãƒ›ã‚¹ãƒˆã«ã‚ã‚‹å ´åˆã¯ãƒ›ã‚¹ãƒˆåã‚’ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

3. **systemd ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ã§è‡ªå‹•èµ·å‹•ã‚’è¨­å®š**

   ```bash
   mkdir -p ~/.config/systemd/user
   cat <<'EOF' > ~/.config/systemd/user/gexel-tunnel.service
   [Unit]
   Description=SSH tunnel to gexel.cloud
   After=network.target

   [Service]
   ExecStart=/usr/bin/ssh -o ExitOnForwardFailure=yes -o ServerAliveInterval=60 -o ServerAliveCountMax=3 -o StrictHostKeyChecking=accept-new gexel-cloud-tunnel -NT
   Restart=always
   RestartSec=5

   [Install]
   WantedBy=default.target
   EOF

   systemctl --user daemon-reload
   systemctl --user enable --now gexel-tunnel.service
   ```

   - `StrictHostKeyChecking=accept-new` ã«ã‚ˆã‚Šåˆå›æ¥ç¶šæ™‚ã«ãƒ›ã‚¹ãƒˆéµã‚’è‡ªå‹•ç™»éŒ²ã—ã¾ã™ã€‚
   - `systemctl --user status gexel-tunnel.service` ã§ç¨¼åƒçŠ¶æ³ã‚’ç¢ºèªã§ãã¾ã™ã€‚<=ãŸã¾ã«å®Ÿè¡Œã™ã‚‹ã€‚>

4. **ç–é€šç¢ºèª**

   - ãƒˆãƒ³ãƒãƒ«ãŒèµ·å‹•ã—ãŸçŠ¶æ…‹ã§ `curl http://localhost:3729/api/mysql/check` ã‚’å®Ÿè¡Œã—ã€`{"ok":true,"connected":true,...}` ãŒè¿”ã‚Œã°æ¥ç¶šæˆåŠŸã§ã™ã€‚


### 10. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®æº–å‚™

```bash
# nextjsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã§å®Ÿè¡Œ
cd nextjs
mkdir -p app/api/logs
mkdir -p components/{ui,features,layouts}
mkdir -p lib/{aws,utils}
mkdir -p types
```

æ¨å¥¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ :
```
/home/yasunari/KNiT/log-analysis/
â”œâ”€â”€ .vscode/
â”‚   â”œâ”€â”€ settings.json    # ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹VSCodeè¨­å®š
â”‚   â””â”€â”€ extensions.json  # æ¨å¥¨æ‹¡å¼µæ©Ÿèƒ½
â”œâ”€â”€ biome.json          # ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ¬ãƒ™ãƒ«Biomeè¨­å®š
â”œâ”€â”€ package.json        # ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ç®¡ç†
â”œâ”€â”€ bun.lock
â”œâ”€â”€ nextjs/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â””â”€â”€ logs/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ globals.css
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”œâ”€â”€ Table.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ DatePicker.tsx
â”‚   â”‚   â”‚   â””â”€â”€ FilterBar.tsx
â”‚   â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â”‚   â””â”€â”€ LogViewer.tsx
â”‚   â”‚   â””â”€â”€ layouts/
â”‚   â”‚       â””â”€â”€ MainLayout.tsx
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ aws/
â”‚   â”‚   â”‚   â””â”€â”€ s3-client.ts
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â”œâ”€â”€ log-parser.ts
â”‚   â”‚       â””â”€â”€ data-normalizer.ts
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ log.ts
â”‚   â”œâ”€â”€ styled-system/
â”‚   â”œâ”€â”€ .env.local
â”‚   â”œâ”€â”€ panda.config.ts
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â””â”€â”€ backend/ (å°†æ¥è¿½åŠ æ™‚)
    â””â”€â”€ package.json
```

## ğŸ§ª é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
# ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã‹ã‚‰èµ·å‹•
cd /home/yasunari/KNiT/log-analysis
bun dev

# ã¾ãŸã¯ nextjsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ç›´æ¥èµ·å‹•
cd /home/yasunari/KNiT/log-analysis/nextjs
bunx panda --watch & bun dev

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèª
# http://localhost:3729
```

## ğŸ“¦ æœ¬ç•ªãƒ“ãƒ«ãƒ‰

```bash
# ãƒ“ãƒ«ãƒ‰
bun run build

# æœ¬ç•ªã‚µãƒ¼ãƒãƒ¼èµ·å‹•
bun run start
```

## ğŸ³ Docker ã§ã®é…å¸ƒãƒ»èµ·å‹•

```bash
# åˆå›ãƒ“ãƒ«ãƒ‰ã¨èµ·å‹•
docker compose up --build

# ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•ã—ãŸã„å ´åˆ
docker compose up -d --build

# åœæ­¢
docker compose down
```

`.env.production` ãªã©ã®ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ `docker-compose.yml` ã® `env_file` ã«æŒ‡å®šã—ã¦èªè¨¼æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚å¤–éƒ¨å…±æœ‰æ™‚ã¯è³‡æ ¼æƒ…å ±ã‚’å«ã‚“ã  env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…å¸ƒã—ãªã„ã‚ˆã†æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

## ğŸ”§ package.jsonã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨­å®š

ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ¬ãƒ™ãƒ« (`/home/yasunari/KNiT/log-analysis/package.json`):
```json
{
  "scripts": {
    "dev": "cd nextjs && bun dev",
    "build": "cd nextjs && bun build",
    "format": "bunx @biomejs/biome format --write .",
    "lint": "bunx @biomejs/biome check .",
    "lint:fix": "bunx @biomejs/biome check --write ."
  }
}
```

Next.jsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ (`nextjs/package.json`):
```json
{
  "scripts": {
    "dev": "bunx panda --watch & next dev --port 3729",
    "build": "bunx panda && next build",
    "start": "next start --port 3729",
    "type-check": "tsc --noEmit"
  }
}
```

## âš ï¸ æ³¨æ„äº‹é …

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- AWSèªè¨¼æƒ…å ±ã¯å¿…ãšç’°å¢ƒå¤‰æ•°ã§ç®¡ç†
- `.env.local`ã¯çµ¶å¯¾ã«Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„
- S3ã‚¢ã‚¯ã‚»ã‚¹ã¯å¿…ãšã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ï¼ˆAPI Routeï¼‰çµŒç”±ã§å®Ÿè¡Œ

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- å¤§é‡ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºæ™‚ã¯TanStack Tableã®ä»®æƒ³åŒ–ã‚’æ´»ç”¨
- S3ã‹ã‚‰ã®å–å¾—ã¯å¿…è¦æœ€å°é™ã«åˆ¶é™ï¼ˆæ—¥ä»˜æŒ‡å®šãªã©ï¼‰

### é–‹ç™ºç’°å¢ƒ
- WSLç’°å¢ƒæ¨å¥¨ï¼ˆWindowsç’°å¢ƒã®å ´åˆï¼‰
- Bunã®é«˜é€Ÿæ€§ã‚’æ´»ã‹ã™ãŸã‚ã€npm/yarnã¯ä½¿ç”¨ã—ãªã„
- **é‡è¦**: VSCodeã¯å¿…ãšãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆ `/home/yasunari/KNiT/log-analysis` ã‹ã‚‰é–‹ã

## ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Ctrl+Sè‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒåŠ¹ã‹ãªã„å ´åˆ
1. VSCodeã‚’ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã‹ã‚‰é–‹ãç›´ã™
   ```bash
   cd /home/yasunari/KNiT/log-analysis
   code .
   ```
2. Biomeæ‹¡å¼µæ©Ÿèƒ½ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
3. ã‚³ãƒãƒ³ãƒ‰ãƒ‘ãƒ¬ãƒƒãƒˆ (Ctrl+Shift+P) ã§ã€ŒFormat Document With...ã€â†’ã€ŒBiomeã€ã‚’é¸æŠ
4. VSCodeã‚’å†èµ·å‹•

### Bunã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¤±æ•—æ™‚
```bash
# æ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
curl -fsSL https://bun.sh/install | bash -s "bun-v1.0.0"
```

### Panda CSSãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼æ™‚
```bash
# nextjsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å®Ÿè¡Œ
cd nextjs
rm -rf styled-system
bunx panda codegen
```

### S3æ¥ç¶šã‚¨ãƒ©ãƒ¼æ™‚
- AWSèªè¨¼æƒ…å ±ã®ç¢ºèª
- IAMãƒãƒªã‚·ãƒ¼ã®æ¨©é™ç¢ºèª
- ãƒªãƒ¼ã‚¸ãƒ§ãƒ³è¨­å®šã®ç¢ºèª

## ğŸ”’ gexel.cloud ã¸ã® SSH ãƒˆãƒ³ãƒãƒ«

- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã® `scripts/setup-gexel-tunnel.sh` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€`~/.config/systemd/user/gexel-tunnel.service` ã®è¨­ç½®ã¨ `systemctl --user enable --now` ã¾ã§è‡ªå‹•åŒ–ã•ã‚Œã¾ã™ã€‚
- çŠ¶æ…‹ç¢ºèªã¯ `scripts/status-gexel-tunnel.sh` ã‚’ä½¿ã†ã¨ `systemctl --user status gexel-tunnel.service` ã‚’æ‰‹è»½ã«å®Ÿè¡Œã§ãã¾ã™ã€‚
- ãƒˆãƒ³ãƒãƒ«ã‚’åœæ­¢ãƒ»å‰Šé™¤ã—ãŸã„å ´åˆã¯ `scripts/remove-gexel-tunnel.sh` ã‚’åˆ©ç”¨ã—ã¦ãã ã•ã„ï¼ˆã‚µãƒ¼ãƒ“ã‚¹åœæ­¢ã€ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ã€`daemon-reload` ã¾ã§ã¾ã¨ã‚ã¦å‡¦ç†ï¼‰ã€‚
- `StrictHostKeyChecking=accept-new` ã‚’æŒ‡å®šã—ã¦ã„ã‚‹ãŸã‚åˆå›æ¥ç¶šæ™‚ã«ãƒ›ã‚¹ãƒˆéµãŒè‡ªå‹•ç™»éŒ²ã•ã‚Œã¾ã™ã€‚ç¨¼åƒçŠ¶æ³ã¯ `systemctl --user status gexel-tunnel.service` ã§éšæ™‚ç¢ºèªã—ã¦ãã ã•ã„ã€‚
- Docker ã‚³ãƒ³ãƒ†ãƒŠã«ã¯ systemd ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„ã®ãŒä¸€èˆ¬çš„ã§ã€ä¸Šè¨˜ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ã‚’ãã®ã¾ã¾å†…åŒ…ã™ã‚‹ã“ã¨ã¯å›°é›£ã§ã™ã€‚Docker åŒ–ã™ã‚‹å ´åˆã¯ ssh ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’å®Ÿè¡Œã™ã‚‹å°‚ç”¨ã‚³ãƒ³ãƒ†ãƒŠã‚’ç”¨æ„ã—ã€`ssh -NT ...` ã‚’ PID1 ã¨ã—ã¦èµ°ã‚‰ã›ã‚‹ã‹ã€systemd å¯¾å¿œãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ¡ç”¨ã™ã‚‹ãªã©è¿½åŠ è¨­å®šãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚
- ãƒˆãƒ³ãƒãƒ«é‹ç”¨ã¯ãƒ›ã‚¹ãƒˆå´ systemd ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦ç®¡ç†ã™ã‚‹ã®ãŒå®‰å…¨ã§ç¢ºå®Ÿã§ã™ã€‚Docker ã§ä»£æ›¿ã™ã‚‹å ´åˆã‚‚ç§˜å¯†éµã‚„ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰è¨­å®šã‚’æ…é‡ã«æ‰±ã„ã€`--net=host` ãªã©ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šãŒå¿…è¦ã«ãªã‚‹ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯
- [Bun Documentation](https://bun.sh/docs)
- [Next.js 15 Documentation](https://nextjs.org/docs)
- [Panda CSS Documentation](https://panda-css.com/docs)
- [TanStack Table Documentation](https://tanstack.com/table/latest)
- [Biome Documentation](https://biomejs.dev/)
